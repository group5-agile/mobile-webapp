<!DOCTYPE html>
<html xmlns:th="http://wwww.thymeleaf.org" xmlns:layout=""
	layout:decorate="~{layouts/admin-layout}">
<head>
<title>Product</title>
</head>
<body>
	<div layout:fragment="content" class="container pt-5 pb-5">
		<div class="row">
			<a th:href="@{/admin/products/add}" id="create-btn"
				class="btn btn-large btn-primary mb-2"
				th:text="#{admin.product.button.add}">Thêm mới</a>
			<table class="table table-sm table-striped table-bordered">
				<thead>
					<tr>
						<th th:text="#{admin.product.table.column.thumbnail}">Ảnh</th>
						<th th:text="#{admin.product.table.column.id}">ID</th>
						<th th:text="#{admin.product.table.column.name}">Name</th>
						<th th:text="#{admin.product.table.column.price}">Price</th>
						<th th:text="#{admin.product.table.column.action}">Action</th>
					</tr>
				</thead>
				<tbody>
					<tr th:each="prod : ${products}" th:object="${prod}">
						<td>
							<img th:src="${prod.thumbnail}" width="60px">
						</td>
						<td th:text="*{id}">ID</td>
						<td th:text="*{name}">Name</td>
						<td th:text="*{#numbers.formatInteger(price, 3, 'POINT')}">Price</td>
						<td>
							<a th:text="#{admin.product.button.edit}"
								th:href="@{/admin/products/update/__*{id}__}"
								class="btn btn-warning edit-btn">Sửa</a>
							<button th:text="#{admin.product.button.remove}"
								th:data-id="*{id}" th:data-name="*{name}"
								class="btn btn-danger remove-btn">Xóa</button>
						</td>
					</tr>
				</tbody>
			</table>
			<nav aria-label="page"
				th:remove="${#lists.size(pagination.controls)}<=1 ? 'ALL' ">
				<ul class="pagination">
					<li class="page-item"
						th:each="control, controlStat: ${pagination.controls}"
						th:classappend="${control.actived} ? 'active'">
						<a class="page-link"
							th:href="${control.page}==1 ? @{/admin/products} : @{/admin/products(page=__${control.page}__)}"
							th:text="${control.label}">1</a>
					</li>
				</ul>
			</nav>
		</div>

		<!-- remove modal -->
		<!-- end remove modal -->

	</div>

	<th:block layout:fragment="script">
		<script>
			$(document).ready(function() {
				$(".remove-btn").click(function(e) {
					e.preventDefault();
					var verify = confirm("Bạn có muốn xóa sản phẩm này không?");
					if (verify) {
						var uri = "/admin/products/delete/";
						var id = $(this).data("id");
						var req = uri.concat(id);
						$.post(req,function(result,	status) {
							if (result) {
								alert("Xóa thành công!");
								location.reload();
							} else
								alert("Xóa thất bại!");
						});
					}
				});
			});
		</script>
	</th:block>
</body>
</html>